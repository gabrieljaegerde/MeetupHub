import{g as dr}from"./index-C95lO3Km.js";var ne={exports:{}},ht;function Sr(){if(ht)return ne.exports;ht=1;var s=typeof Reflect=="object"?Reflect:null,t=s&&typeof s.apply=="function"?s.apply:function(h,p,L){return Function.prototype.apply.call(h,p,L)},n;s&&typeof s.ownKeys=="function"?n=s.ownKeys:Object.getOwnPropertySymbols?n=function(h){return Object.getOwnPropertyNames(h).concat(Object.getOwnPropertySymbols(h))}:n=function(h){return Object.getOwnPropertyNames(h)};function r(E){console&&console.warn&&console.warn(E)}var i=Number.isNaN||function(h){return h!==h};function o(){o.init.call(this)}ne.exports=o,ne.exports.once=y,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function l(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(E){if(typeof E!="number"||E<0||i(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");a=E}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(h){if(typeof h!="number"||h<0||i(h))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+h+".");return this._maxListeners=h,this};function c(E){return E._maxListeners===void 0?o.defaultMaxListeners:E._maxListeners}o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(h){for(var p=[],L=1;L<arguments.length;L++)p.push(arguments[L]);var m=h==="error",C=this._events;if(C!==void 0)m=m&&C.error===void 0;else if(!m)return!1;if(m){var $;if(p.length>0&&($=p[0]),$ instanceof Error)throw $;var M=new Error("Unhandled error."+($?" ("+$.message+")":""));throw M.context=$,M}var k=C[h];if(k===void 0)return!1;if(typeof k=="function")t(k,this,p);else for(var Y=k.length,g=S(k,Y),L=0;L<Y;++L)t(g[L],this,p);return!0};function d(E,h,p,L){var m,C,$;if(l(p),C=E._events,C===void 0?(C=E._events=Object.create(null),E._eventsCount=0):(C.newListener!==void 0&&(E.emit("newListener",h,p.listener?p.listener:p),C=E._events),$=C[h]),$===void 0)$=C[h]=p,++E._eventsCount;else if(typeof $=="function"?$=C[h]=L?[p,$]:[$,p]:L?$.unshift(p):$.push(p),m=c(E),m>0&&$.length>m&&!$.warned){$.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(h)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=E,M.type=h,M.count=$.length,r(M)}return E}o.prototype.addListener=function(h,p){return d(this,h,p,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(h,p){return d(this,h,p,!0)};function e(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(E,h,p){var L={fired:!1,wrapFn:void 0,target:E,type:h,listener:p},m=e.bind(L);return m.listener=p,L.wrapFn=m,m}o.prototype.once=function(h,p){return l(p),this.on(h,u(this,h,p)),this},o.prototype.prependOnceListener=function(h,p){return l(p),this.prependListener(h,u(this,h,p)),this},o.prototype.removeListener=function(h,p){var L,m,C,$,M;if(l(p),m=this._events,m===void 0)return this;if(L=m[h],L===void 0)return this;if(L===p||L.listener===p)--this._eventsCount===0?this._events=Object.create(null):(delete m[h],m.removeListener&&this.emit("removeListener",h,L.listener||p));else if(typeof L!="function"){for(C=-1,$=L.length-1;$>=0;$--)if(L[$]===p||L[$].listener===p){M=L[$].listener,C=$;break}if(C<0)return this;C===0?L.shift():v(L,C),L.length===1&&(m[h]=L[0]),m.removeListener!==void 0&&this.emit("removeListener",h,M||p)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(h){var p,L,m;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[h]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete L[h]),this;if(arguments.length===0){var C=Object.keys(L),$;for(m=0;m<C.length;++m)$=C[m],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(p=L[h],typeof p=="function")this.removeListener(h,p);else if(p!==void 0)for(m=p.length-1;m>=0;m--)this.removeListener(h,p[m]);return this};function f(E,h,p){var L=E._events;if(L===void 0)return[];var m=L[h];return m===void 0?[]:typeof m=="function"?p?[m.listener||m]:[m]:p?w(m):S(m,m.length)}o.prototype.listeners=function(h){return f(this,h,!0)},o.prototype.rawListeners=function(h){return f(this,h,!1)},o.listenerCount=function(E,h){return typeof E.listenerCount=="function"?E.listenerCount(h):I.call(E,h)},o.prototype.listenerCount=I;function I(E){var h=this._events;if(h!==void 0){var p=h[E];if(typeof p=="function")return 1;if(p!==void 0)return p.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function S(E,h){for(var p=new Array(h),L=0;L<h;++L)p[L]=E[L];return p}function v(E,h){for(;h+1<E.length;h++)E[h]=E[h+1];E.pop()}function w(E){for(var h=new Array(E.length),p=0;p<h.length;++p)h[p]=E[p].listener||E[p];return h}function y(E,h){return new Promise(function(p,L){function m($){E.removeListener(h,C),L($)}function C(){typeof E.removeListener=="function"&&E.removeListener("error",m),p([].slice.call(arguments))}P(E,h,C,{once:!0}),h!=="error"&&U(E,m,{once:!0})})}function U(E,h,p){typeof E.on=="function"&&P(E,"error",h,p)}function P(E,h,p,L){if(typeof E.on=="function")L.once?E.once(h,p):E.on(h,p);else if(typeof E.addEventListener=="function")E.addEventListener(h,function m(C){L.once&&E.removeEventListener(h,m),p(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return ne.exports}var Tr=Sr();const _r=dr(Tr),wr={},Er=(s,t)=>{wr[s]=t},J=s=>{class t extends Error{constructor(r,i,o){if(super(r||s,o),Object.setPrototypeOf(this,t.prototype),this.name=s,i)for(const a in i)this[a]=i[a];if(o&&Ar(o)&&"cause"in o&&!("cause"in this)){const a=o.cause;this.cause=a,"stack"in a&&(this.stack=this.stack+`
CAUSE: `+a.stack)}}}return t};function Ar(s){return typeof s=="object"}const $r=J("DisconnectedDevice"),xr=J("DisconnectedDeviceDuringOperation"),yr=J("TransportOpenUserCancelled"),dt=J("TransportInterfaceNotAvailable"),Cr=J("TransportRaceCondition"),Pr=J("TransportWebUSBGestureRequired");var Et;(function(s){s.Unknown="Unknown",s.LocationServicesDisabled="LocationServicesDisabled",s.LocationServicesUnauthorized="LocationServicesUnauthorized",s.BluetoothScanStartFailed="BluetoothScanStartFailed"})(Et||(Et={}));class H extends Error{constructor(t,n){const r="TransportError";super(t||r),this.name=r,this.message=t,this.stack=new Error(t).stack,this.id=n}}Er("TransportError",s=>new H(s.message,s.id));const W={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698,TRUSTCHAIN_WRONG_SEED:45063};function Dr(s){switch(s){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=s&&s<=28671)return"Internal error, please report"}class Z extends Error{constructor(t,{canBeMappedToChildError:n=!0}={}){const r=Object.keys(W).find(l=>W[l]===t)||"UNKNOWN_ERROR",i=Dr(t)||r,o=t.toString(16),a=`Ledger device: ${i} (0x${o})`;if(super(a),this.name="TransportStatusError",this.statusCode=t,this.statusText=r,Object.setPrototypeOf(this,Z.prototype),n&&t===W.LOCKED_DEVICE)return new rt(a)}}class rt extends Z{constructor(t){super(W.LOCKED_DEVICE,{canBeMappedToChildError:!1}),t&&(this.message=t),this.name="LockedDeviceError",Object.setPrototypeOf(this,rt.prototype)}}Er("TransportStatusError",s=>new Z(s.statusCode));let pr=0;const X=[],pt=(s,t,n)=>{const r={type:s,id:String(++pr),date:new Date};t&&(r.message=t),mr(r)},br=({type:s,message:t,data:n,context:r})=>{const i={type:s,id:String(++pr),date:new Date};t&&(i.message=t),n&&(i.data=n),r&&(i.context=r),mr(i)};class te{constructor(t,n){this.type=t,this.context=n}trace(t,n){br({type:this.type,message:t,data:n,context:this.context})}getContext(){return this.context}setContext(t){this.context=t}updateContext(t){this.context=Object.assign(Object.assign({},this.context),t)}getType(){return this.type}setType(t){this.type=t}withType(t){return new te(t,this.context)}withContext(t){return new te(this.type,t)}withUpdatedContext(t){return new te(this.type,Object.assign(Object.assign({},this.context),t))}}const Ur=s=>(X.push(s),()=>{const t=X.indexOf(s);t!==-1&&(X[t]=X[X.length-1],X.pop())});function mr(s){for(let t=0;t<X.length;t++)try{X[t](s)}catch(n){console.error(n)}}typeof window<"u"&&(window.__ledgerLogsListen=Ur);var se=function(s,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(e){try{d(r.next(e))}catch(u){a(u)}}function c(e){try{d(r.throw(e))}catch(u){a(u)}}function d(e){e.done?o(e.value):i(e.value).then(l,c)}d((r=r.apply(s,t||[])).next())})};const qr="transport";class nt{constructor({context:t,logType:n}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new _r,this.send=(r,i,o,a,...l)=>se(this,[r,i,o,a,...l],void 0,function*(c,d,e,u,f=Buffer.alloc(0),I=[W.OK],{abortTimeoutMs:S}={}){const v=this.tracer.withUpdatedContext({function:"send"});if(f.length>=256)throw v.trace("data.length exceeded 256 bytes limit",{dataLength:f.length}),new H("data.length exceed 256 bytes limit. Got: "+f.length,"DataLengthTooBig");v.trace("Starting an exchange",{abortTimeoutMs:S});const w=yield this.exchange(Buffer.concat([Buffer.from([c,d,e,u]),Buffer.from([f.length]),f]),{abortTimeoutMs:S});v.trace("Received response from exchange");const y=w.readUInt16BE(w.length-2);if(!I.some(U=>U===y))throw new Z(y);return w}),this._appAPIlock=null,this.tracer=new te(n??qr,t)}exchange(t,{abortTimeoutMs:n}={}){throw new Error("exchange not implemented")}exchangeBulk(t,n){let r=!1;const i=()=>{r=!0};return se(this,void 0,void 0,function*(){if(!r)for(const a of t){const l=yield this.exchange(a);if(r)return;const c=l.readUInt16BE(l.length-2);if(c!==W.OK)throw new Z(c);n.next(l)}}).then(()=>!r&&n.complete(),a=>!r&&n.error(a)),{unsubscribe:i}}setScrambleKey(t){}close(){return Promise.resolve()}on(t,n){this._events.on(t,n)}off(t,n){this._events.removeListener(t,n)}emit(t,...n){this._events.emit(t,...n)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(t){this.exchangeTimeout=t}setExchangeUnresponsiveTimeout(t){this.unresponsiveTimeout=t}static create(t=3e3,n){return new Promise((r,i)=>{let o=!1;const a=this.listen({next:c=>{o=!0,a&&a.unsubscribe(),l&&clearTimeout(l),this.open(c.descriptor,t).then(r,i)},error:c=>{l&&clearTimeout(l),i(c)},complete:()=>{l&&clearTimeout(l),o||i(new H(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),l=n?setTimeout(()=>{a.unsubscribe(),i(new H(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},n):null})}exchangeAtomicImpl(t){return se(this,void 0,void 0,function*(){const n=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw n.trace("Atomic exchange is already busy"),new Cr("An action was already pending on the Ledger device. Please deny or reconnect.");let r;const i=new Promise(l=>{r=l});this.exchangeBusyPromise=i;let o=!1;const a=setTimeout(()=>{n.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),o=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const l=yield t();return o&&(n.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),l}finally{n.trace("Finalize, clearing busy guard"),clearTimeout(a),r&&r(),this.exchangeBusyPromise=null}})}decorateAppAPIMethods(t,n,r){for(const i of n)t[i]=this.decorateAppAPIMethod(i,t[i],t,r)}decorateAppAPIMethod(t,n,r,i){return(...o)=>se(this,void 0,void 0,function*(){const{_appAPIlock:a}=this;if(a)return Promise.reject(new H("Ledger Device is busy (lock "+a+")","TransportLocked"));try{return this._appAPIlock=t,this.setScrambleKey(i),yield n.apply(r,o)}finally{this._appAPIlock=null}})}setTraceContext(t){this.tracer=this.tracer.withContext(t)}updateTraceContext(t){this.tracer.updateContext(t)}getTraceContext(){return this.tracer.getContext()}}nt.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";nt.ErrorMessage_NoDeviceFound="No Ledger device found";const mt=5;function Fr(s){const t=Buffer.alloc(2);return t.writeUInt16BE(s,0),t}const Mr={data:Buffer.alloc(0),dataLength:0,sequence:0},Gr=(s,t)=>({makeBlocks(n){let r=Buffer.concat([Fr(n.length),n]);const i=t-5,o=Math.ceil(r.length/i);r=Buffer.concat([r,Buffer.alloc(o*i-r.length+1).fill(0)]);const a=[];for(let l=0;l<o;l++){const c=Buffer.alloc(5);c.writeUInt16BE(s,0),c.writeUInt8(mt,2),c.writeUInt16BE(l,3);const d=r.slice(l*i,(l+1)*i);a.push(Buffer.concat([c,d]))}return a},reduceResponse(n,r){let{data:i,dataLength:o,sequence:a}=n||Mr;if(r.readUInt16BE(0)!==s)throw new H("Invalid channel","InvalidChannel");if(r.readUInt8(2)!==mt)throw new H("Invalid tag","InvalidTag");if(r.readUInt16BE(3)!==a)throw new H("Invalid sequence","InvalidSequence");n||(o=r.readUInt16BE(5)),a++;const l=r.slice(n?5:7);return i=Buffer.concat([i,l]),i.length>o&&(i=i.slice(0,o)),{data:i,dataLength:o,sequence:a}},getReducedResult(n){if(n&&n.dataLength===n.data.length)return n.data}});var ie={exports:{}},fe,vt;function oe(){if(vt)return fe;vt=1;const s="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,i=t-6;return fe={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},fe}var he,Rt;function ae(){if(Rt)return he;Rt=1;var s={};return he=typeof process=="object"&&s&&s.NODE_DEBUG&&/\bsemver\b/i.test(s.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},he}var It;function re(){return It||(It=1,function(s,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=oe(),o=ae();t=s.exports={};const a=t.re=[],l=t.safeRe=[],c=t.src=[],d=t.safeSrc=[],e=t.t={};let u=0;const f="[a-zA-Z0-9-]",I=[["\\s",1],["\\d",i],[f,r]],S=w=>{for(const[y,U]of I)w=w.split(`${y}*`).join(`${y}{0,${U}}`).split(`${y}+`).join(`${y}{1,${U}}`);return w},v=(w,y,U)=>{const P=S(y),E=u++;o(w,E,y),e[w]=E,c[E]=y,d[E]=P,a[E]=new RegExp(y,U?"g":void 0),l[E]=new RegExp(P,U?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),v("MAINVERSION",`(${c[e.NUMERICIDENTIFIER]})\\.(${c[e.NUMERICIDENTIFIER]})\\.(${c[e.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${c[e.NUMERICIDENTIFIERLOOSE]})\\.(${c[e.NUMERICIDENTIFIERLOOSE]})\\.(${c[e.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${c[e.NUMERICIDENTIFIER]}|${c[e.NONNUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${c[e.NUMERICIDENTIFIERLOOSE]}|${c[e.NONNUMERICIDENTIFIER]})`),v("PRERELEASE",`(?:-(${c[e.PRERELEASEIDENTIFIER]}(?:\\.${c[e.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${c[e.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[e.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${f}+`),v("BUILD",`(?:\\+(${c[e.BUILDIDENTIFIER]}(?:\\.${c[e.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${c[e.MAINVERSION]}${c[e.PRERELEASE]}?${c[e.BUILD]}?`),v("FULL",`^${c[e.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${c[e.MAINVERSIONLOOSE]}${c[e.PRERELEASELOOSE]}?${c[e.BUILD]}?`),v("LOOSE",`^${c[e.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${c[e.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${c[e.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${c[e.XRANGEIDENTIFIER]})(?:\\.(${c[e.XRANGEIDENTIFIER]})(?:\\.(${c[e.XRANGEIDENTIFIER]})(?:${c[e.PRERELEASE]})?${c[e.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${c[e.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[e.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[e.XRANGEIDENTIFIERLOOSE]})(?:${c[e.PRERELEASELOOSE]})?${c[e.BUILD]}?)?)?`),v("XRANGE",`^${c[e.GTLT]}\\s*${c[e.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${c[e.GTLT]}\\s*${c[e.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),v("COERCE",`${c[e.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",c[e.COERCEPLAIN]+`(?:${c[e.PRERELEASE]})?(?:${c[e.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",c[e.COERCE],!0),v("COERCERTLFULL",c[e.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${c[e.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",v("TILDE",`^${c[e.LONETILDE]}${c[e.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${c[e.LONETILDE]}${c[e.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${c[e.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",v("CARET",`^${c[e.LONECARET]}${c[e.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${c[e.LONECARET]}${c[e.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${c[e.GTLT]}\\s*(${c[e.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${c[e.GTLT]}\\s*(${c[e.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${c[e.GTLT]}\\s*(${c[e.LOOSEPLAIN]}|${c[e.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${c[e.XRANGEPLAIN]})\\s+-\\s+(${c[e.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${c[e.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[e.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(ie,ie.exports)),ie.exports}var de,Lt;function st(){if(Lt)return de;Lt=1;const s=Object.freeze({loose:!0}),t=Object.freeze({});return de=r=>r?typeof r!="object"?s:r:t,de}var Ee,gt;function vr(){if(gt)return Ee;gt=1;const s=/^[0-9]+$/,t=(r,i)=>{const o=s.test(r),a=s.test(i);return o&&a&&(r=+r,i=+i),r===i?0:o&&!a?-1:a&&!o?1:r<i?-1:1};return Ee={compareIdentifiers:t,rcompareIdentifiers:(r,i)=>t(i,r)},Ee}var pe,Nt;function j(){if(Nt)return pe;Nt=1;const s=ae(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=oe(),{safeRe:r,safeSrc:i,t:o}=re(),a=st(),{compareIdentifiers:l}=vr();class c{constructor(e,u){if(u=a(u),e instanceof c){if(e.loose===!!u.loose&&e.includePrerelease===!!u.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>t)throw new TypeError(`version is longer than ${t} characters`);s("SemVer",e,u),this.options=u,this.loose=!!u.loose,this.includePrerelease=!!u.includePrerelease;const f=e.trim().match(u.loose?r[o.LOOSE]:r[o.FULL]);if(!f)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+f[1],this.minor=+f[2],this.patch=+f[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");f[4]?this.prerelease=f[4].split(".").map(I=>{if(/^[0-9]+$/.test(I)){const S=+I;if(S>=0&&S<n)return S}return I}):this.prerelease=[],this.build=f[5]?f[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if(typeof e=="string"&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let u=0;do{const f=this.prerelease[u],I=e.prerelease[u];if(s("prerelease compare",u,f,I),f===void 0&&I===void 0)return 0;if(I===void 0)return 1;if(f===void 0)return-1;if(f===I)continue;return l(f,I)}while(++u)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let u=0;do{const f=this.build[u],I=e.build[u];if(s("build compare",u,f,I),f===void 0&&I===void 0)return 0;if(I===void 0)return 1;if(f===void 0)return-1;if(f===I)continue;return l(f,I)}while(++u)}inc(e,u,f){if(e.startsWith("pre")){if(!u&&f===!1)throw new Error("invalid increment argument: identifier is empty");if(u){const I=new RegExp(`^${this.options.loose?i[o.PRERELEASELOOSE]:i[o.PRERELEASE]}$`),S=`-${u}`.match(I);if(!S||S[1]!==u)throw new Error(`invalid identifier: ${u}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",u,f);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",u,f);break;case"prepatch":this.prerelease.length=0,this.inc("patch",u,f),this.inc("pre",u,f);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",u,f),this.inc("pre",u,f);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const I=Number(f)?1:0;if(this.prerelease.length===0)this.prerelease=[I];else{let S=this.prerelease.length;for(;--S>=0;)typeof this.prerelease[S]=="number"&&(this.prerelease[S]++,S=-2);if(S===-1){if(u===this.prerelease.join(".")&&f===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(I)}}if(u){let S=[u,I];f===!1&&(S=[u]),l(this.prerelease[0],u)===0?isNaN(this.prerelease[1])&&(this.prerelease=S):this.prerelease=S}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return pe=c,pe}var me,Ot;function Q(){if(Ot)return me;Ot=1;const s=j();return me=(n,r,i=!1)=>{if(n instanceof s)return n;try{return new s(n,r)}catch(o){if(!i)return null;throw o}},me}var ve,St;function jr(){if(St)return ve;St=1;const s=Q();return ve=(n,r)=>{const i=s(n,r);return i?i.version:null},ve}var Re,Tt;function Br(){if(Tt)return Re;Tt=1;const s=Q();return Re=(n,r)=>{const i=s(n.trim().replace(/^[=v]+/,""),r);return i?i.version:null},Re}var Ie,_t;function Vr(){if(_t)return Ie;_t=1;const s=j();return Ie=(n,r,i,o,a)=>{typeof i=="string"&&(a=o,o=i,i=void 0);try{return new s(n instanceof s?n.version:n,i).inc(r,o,a).version}catch{return null}},Ie}var Le,wt;function kr(){if(wt)return Le;wt=1;const s=Q();return Le=(n,r)=>{const i=s(n,null,!0),o=s(r,null,!0),a=i.compare(o);if(a===0)return null;const l=a>0,c=l?i:o,d=l?o:i,e=!!c.prerelease.length;if(!!d.prerelease.length&&!e){if(!d.patch&&!d.minor)return"major";if(d.compareMain(c)===0)return d.minor&&!d.patch?"minor":"patch"}const f=e?"pre":"";return i.major!==o.major?f+"major":i.minor!==o.minor?f+"minor":i.patch!==o.patch?f+"patch":"prerelease"},Le}var ge,At;function Xr(){if(At)return ge;At=1;const s=j();return ge=(n,r)=>new s(n,r).major,ge}var Ne,$t;function Hr(){if($t)return Ne;$t=1;const s=j();return Ne=(n,r)=>new s(n,r).minor,Ne}var Oe,xt;function zr(){if(xt)return Oe;xt=1;const s=j();return Oe=(n,r)=>new s(n,r).patch,Oe}var Se,yt;function Kr(){if(yt)return Se;yt=1;const s=Q();return Se=(n,r)=>{const i=s(n,r);return i&&i.prerelease.length?i.prerelease:null},Se}var Te,Ct;function B(){if(Ct)return Te;Ct=1;const s=j();return Te=(n,r,i)=>new s(n,i).compare(new s(r,i)),Te}var _e,Pt;function Yr(){if(Pt)return _e;Pt=1;const s=B();return _e=(n,r,i)=>s(r,n,i),_e}var we,Dt;function Wr(){if(Dt)return we;Dt=1;const s=B();return we=(n,r)=>s(n,r,!0),we}var Ae,bt;function it(){if(bt)return Ae;bt=1;const s=j();return Ae=(n,r,i)=>{const o=new s(n,i),a=new s(r,i);return o.compare(a)||o.compareBuild(a)},Ae}var $e,Ut;function Zr(){if(Ut)return $e;Ut=1;const s=it();return $e=(n,r)=>n.sort((i,o)=>s(i,o,r)),$e}var xe,qt;function Jr(){if(qt)return xe;qt=1;const s=it();return xe=(n,r)=>n.sort((i,o)=>s(o,i,r)),xe}var ye,Ft;function ce(){if(Ft)return ye;Ft=1;const s=B();return ye=(n,r,i)=>s(n,r,i)>0,ye}var Ce,Mt;function ot(){if(Mt)return Ce;Mt=1;const s=B();return Ce=(n,r,i)=>s(n,r,i)<0,Ce}var Pe,Gt;function Rr(){if(Gt)return Pe;Gt=1;const s=B();return Pe=(n,r,i)=>s(n,r,i)===0,Pe}var De,jt;function Ir(){if(jt)return De;jt=1;const s=B();return De=(n,r,i)=>s(n,r,i)!==0,De}var be,Bt;function at(){if(Bt)return be;Bt=1;const s=B();return be=(n,r,i)=>s(n,r,i)>=0,be}var Ue,Vt;function ct(){if(Vt)return Ue;Vt=1;const s=B();return Ue=(n,r,i)=>s(n,r,i)<=0,Ue}var qe,kt;function Lr(){if(kt)return qe;kt=1;const s=Rr(),t=Ir(),n=ce(),r=at(),i=ot(),o=ct();return qe=(l,c,d,e)=>{switch(c){case"===":return typeof l=="object"&&(l=l.version),typeof d=="object"&&(d=d.version),l===d;case"!==":return typeof l=="object"&&(l=l.version),typeof d=="object"&&(d=d.version),l!==d;case"":case"=":case"==":return s(l,d,e);case"!=":return t(l,d,e);case">":return n(l,d,e);case">=":return r(l,d,e);case"<":return i(l,d,e);case"<=":return o(l,d,e);default:throw new TypeError(`Invalid operator: ${c}`)}},qe}var Fe,Xt;function Qr(){if(Xt)return Fe;Xt=1;const s=j(),t=Q(),{safeRe:n,t:r}=re();return Fe=(o,a)=>{if(o instanceof s)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;a=a||{};let l=null;if(!a.rtl)l=o.match(a.includePrerelease?n[r.COERCEFULL]:n[r.COERCE]);else{const I=a.includePrerelease?n[r.COERCERTLFULL]:n[r.COERCERTL];let S;for(;(S=I.exec(o))&&(!l||l.index+l[0].length!==o.length);)(!l||S.index+S[0].length!==l.index+l[0].length)&&(l=S),I.lastIndex=S.index+S[1].length+S[2].length;I.lastIndex=-1}if(l===null)return null;const c=l[2],d=l[3]||"0",e=l[4]||"0",u=a.includePrerelease&&l[5]?`-${l[5]}`:"",f=a.includePrerelease&&l[6]?`+${l[6]}`:"";return t(`${c}.${d}.${e}${u}${f}`,a)},Fe}var Me,Ht;function en(){if(Ht)return Me;Ht=1;class s{constructor(){this.max=1e3,this.map=new Map}get(n){const r=this.map.get(n);if(r!==void 0)return this.map.delete(n),this.map.set(n,r),r}delete(n){return this.map.delete(n)}set(n,r){if(!this.delete(n)&&r!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(n,r)}return this}}return Me=s,Me}var Ge,zt;function V(){if(zt)return Ge;zt=1;const s=/\s+/g;class t{constructor(R,T){if(T=i(T),R instanceof t)return R.loose===!!T.loose&&R.includePrerelease===!!T.includePrerelease?R:new t(R.raw,T);if(R instanceof o)return this.raw=R.value,this.set=[[R]],this.formatted=void 0,this;if(this.options=T,this.loose=!!T.loose,this.includePrerelease=!!T.includePrerelease,this.raw=R.trim().replace(s," "),this.set=this.raw.split("||").map(N=>this.parseRange(N.trim())).filter(N=>N.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const N=this.set[0];if(this.set=this.set.filter(_=>!v(_[0])),this.set.length===0)this.set=[N];else if(this.set.length>1){for(const _ of this.set)if(_.length===1&&w(_[0])){this.set=[_];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let R=0;R<this.set.length;R++){R>0&&(this.formatted+="||");const T=this.set[R];for(let N=0;N<T.length;N++)N>0&&(this.formatted+=" "),this.formatted+=T[N].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(R){const N=((this.options.includePrerelease&&I)|(this.options.loose&&S))+":"+R,_=r.get(N);if(_)return _;const O=this.options.loose,A=O?c[d.HYPHENRANGELOOSE]:c[d.HYPHENRANGE];R=R.replace(A,k(this.options.includePrerelease)),a("hyphen replace",R),R=R.replace(c[d.COMPARATORTRIM],e),a("comparator trim",R),R=R.replace(c[d.TILDETRIM],u),a("tilde trim",R),R=R.replace(c[d.CARETTRIM],f),a("caret trim",R);let D=R.split(" ").map(q=>U(q,this.options)).join(" ").split(/\s+/).map(q=>M(q,this.options));O&&(D=D.filter(q=>(a("loose invalid filter",q,this.options),!!q.match(c[d.COMPARATORLOOSE])))),a("range list",D);const x=new Map,b=D.map(q=>new o(q,this.options));for(const q of b){if(v(q))return[q];x.set(q.value,q)}x.size>1&&x.has("")&&x.delete("");const G=[...x.values()];return r.set(N,G),G}intersects(R,T){if(!(R instanceof t))throw new TypeError("a Range is required");return this.set.some(N=>y(N,T)&&R.set.some(_=>y(_,T)&&N.every(O=>_.every(A=>O.intersects(A,T)))))}test(R){if(!R)return!1;if(typeof R=="string")try{R=new l(R,this.options)}catch{return!1}for(let T=0;T<this.set.length;T++)if(Y(this.set[T],R,this.options))return!0;return!1}}Ge=t;const n=en(),r=new n,i=st(),o=ue(),a=ae(),l=j(),{safeRe:c,t:d,comparatorTrimReplace:e,tildeTrimReplace:u,caretTrimReplace:f}=re(),{FLAG_INCLUDE_PRERELEASE:I,FLAG_LOOSE:S}=oe(),v=g=>g.value==="<0.0.0-0",w=g=>g.value==="",y=(g,R)=>{let T=!0;const N=g.slice();let _=N.pop();for(;T&&N.length;)T=N.every(O=>_.intersects(O,R)),_=N.pop();return T},U=(g,R)=>(a("comp",g,R),g=p(g,R),a("caret",g),g=E(g,R),a("tildes",g),g=m(g,R),a("xrange",g),g=$(g,R),a("stars",g),g),P=g=>!g||g.toLowerCase()==="x"||g==="*",E=(g,R)=>g.trim().split(/\s+/).map(T=>h(T,R)).join(" "),h=(g,R)=>{const T=R.loose?c[d.TILDELOOSE]:c[d.TILDE];return g.replace(T,(N,_,O,A,D)=>{a("tilde",g,N,_,O,A,D);let x;return P(_)?x="":P(O)?x=`>=${_}.0.0 <${+_+1}.0.0-0`:P(A)?x=`>=${_}.${O}.0 <${_}.${+O+1}.0-0`:D?(a("replaceTilde pr",D),x=`>=${_}.${O}.${A}-${D} <${_}.${+O+1}.0-0`):x=`>=${_}.${O}.${A} <${_}.${+O+1}.0-0`,a("tilde return",x),x})},p=(g,R)=>g.trim().split(/\s+/).map(T=>L(T,R)).join(" "),L=(g,R)=>{a("caret",g,R);const T=R.loose?c[d.CARETLOOSE]:c[d.CARET],N=R.includePrerelease?"-0":"";return g.replace(T,(_,O,A,D,x)=>{a("caret",g,_,O,A,D,x);let b;return P(O)?b="":P(A)?b=`>=${O}.0.0${N} <${+O+1}.0.0-0`:P(D)?O==="0"?b=`>=${O}.${A}.0${N} <${O}.${+A+1}.0-0`:b=`>=${O}.${A}.0${N} <${+O+1}.0.0-0`:x?(a("replaceCaret pr",x),O==="0"?A==="0"?b=`>=${O}.${A}.${D}-${x} <${O}.${A}.${+D+1}-0`:b=`>=${O}.${A}.${D}-${x} <${O}.${+A+1}.0-0`:b=`>=${O}.${A}.${D}-${x} <${+O+1}.0.0-0`):(a("no pr"),O==="0"?A==="0"?b=`>=${O}.${A}.${D}${N} <${O}.${A}.${+D+1}-0`:b=`>=${O}.${A}.${D}${N} <${O}.${+A+1}.0-0`:b=`>=${O}.${A}.${D} <${+O+1}.0.0-0`),a("caret return",b),b})},m=(g,R)=>(a("replaceXRanges",g,R),g.split(/\s+/).map(T=>C(T,R)).join(" ")),C=(g,R)=>{g=g.trim();const T=R.loose?c[d.XRANGELOOSE]:c[d.XRANGE];return g.replace(T,(N,_,O,A,D,x)=>{a("xRange",g,N,_,O,A,D,x);const b=P(O),G=b||P(A),q=G||P(D),ee=q;return _==="="&&ee&&(_=""),x=R.includePrerelease?"-0":"",b?_===">"||_==="<"?N="<0.0.0-0":N="*":_&&ee?(G&&(A=0),D=0,_===">"?(_=">=",G?(O=+O+1,A=0,D=0):(A=+A+1,D=0)):_==="<="&&(_="<",G?O=+O+1:A=+A+1),_==="<"&&(x="-0"),N=`${_+O}.${A}.${D}${x}`):G?N=`>=${O}.0.0${x} <${+O+1}.0.0-0`:q&&(N=`>=${O}.${A}.0${x} <${O}.${+A+1}.0-0`),a("xRange return",N),N})},$=(g,R)=>(a("replaceStars",g,R),g.trim().replace(c[d.STAR],"")),M=(g,R)=>(a("replaceGTE0",g,R),g.trim().replace(c[R.includePrerelease?d.GTE0PRE:d.GTE0],"")),k=g=>(R,T,N,_,O,A,D,x,b,G,q,ee)=>(P(N)?T="":P(_)?T=`>=${N}.0.0${g?"-0":""}`:P(O)?T=`>=${N}.${_}.0${g?"-0":""}`:A?T=`>=${T}`:T=`>=${T}${g?"-0":""}`,P(b)?x="":P(G)?x=`<${+b+1}.0.0-0`:P(q)?x=`<${b}.${+G+1}.0-0`:ee?x=`<=${b}.${G}.${q}-${ee}`:g?x=`<${b}.${G}.${+q+1}-0`:x=`<=${x}`,`${T} ${x}`.trim()),Y=(g,R,T)=>{for(let N=0;N<g.length;N++)if(!g[N].test(R))return!1;if(R.prerelease.length&&!T.includePrerelease){for(let N=0;N<g.length;N++)if(a(g[N].semver),g[N].semver!==o.ANY&&g[N].semver.prerelease.length>0){const _=g[N].semver;if(_.major===R.major&&_.minor===R.minor&&_.patch===R.patch)return!0}return!1}return!0};return Ge}var je,Kt;function ue(){if(Kt)return je;Kt=1;const s=Symbol("SemVer ANY");class t{static get ANY(){return s}constructor(e,u){if(u=n(u),e instanceof t){if(e.loose===!!u.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),a("comparator",e,u),this.options=u,this.loose=!!u.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(e){const u=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],f=e.match(u);if(!f)throw new TypeError(`Invalid comparator: ${e}`);this.operator=f[1]!==void 0?f[1]:"",this.operator==="="&&(this.operator=""),f[2]?this.semver=new l(f[2],this.options.loose):this.semver=s}toString(){return this.value}test(e){if(a("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if(typeof e=="string")try{e=new l(e,this.options)}catch{return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,u){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new c(e.value,u).test(this.value):e.operator===""?e.value===""?!0:new c(this.value,u).test(e.semver):(u=n(u),u.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!u.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||o(this.semver,"<",e.semver,u)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||o(this.semver,">",e.semver,u)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}je=t;const n=st(),{safeRe:r,t:i}=re(),o=Lr(),a=ae(),l=j(),c=V();return je}var Be,Yt;function le(){if(Yt)return Be;Yt=1;const s=V();return Be=(n,r,i)=>{try{r=new s(r,i)}catch{return!1}return r.test(n)},Be}var Ve,Wt;function tn(){if(Wt)return Ve;Wt=1;const s=V();return Ve=(n,r)=>new s(n,r).set.map(i=>i.map(o=>o.value).join(" ").trim().split(" ")),Ve}var ke,Zt;function rn(){if(Zt)return ke;Zt=1;const s=j(),t=V();return ke=(r,i,o)=>{let a=null,l=null,c=null;try{c=new t(i,o)}catch{return null}return r.forEach(d=>{c.test(d)&&(!a||l.compare(d)===-1)&&(a=d,l=new s(a,o))}),a},ke}var Xe,Jt;function nn(){if(Jt)return Xe;Jt=1;const s=j(),t=V();return Xe=(r,i,o)=>{let a=null,l=null,c=null;try{c=new t(i,o)}catch{return null}return r.forEach(d=>{c.test(d)&&(!a||l.compare(d)===1)&&(a=d,l=new s(a,o))}),a},Xe}var He,Qt;function sn(){if(Qt)return He;Qt=1;const s=j(),t=V(),n=ce();return He=(i,o)=>{i=new t(i,o);let a=new s("0.0.0");if(i.test(a)||(a=new s("0.0.0-0"),i.test(a)))return a;a=null;for(let l=0;l<i.set.length;++l){const c=i.set[l];let d=null;c.forEach(e=>{const u=new s(e.semver.version);switch(e.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!d||n(u,d))&&(d=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),d&&(!a||n(a,d))&&(a=d)}return a&&i.test(a)?a:null},He}var ze,er;function on(){if(er)return ze;er=1;const s=V();return ze=(n,r)=>{try{return new s(n,r).range||"*"}catch{return null}},ze}var Ke,tr;function ut(){if(tr)return Ke;tr=1;const s=j(),t=ue(),{ANY:n}=t,r=V(),i=le(),o=ce(),a=ot(),l=ct(),c=at();return Ke=(e,u,f,I)=>{e=new s(e,I),u=new r(u,I);let S,v,w,y,U;switch(f){case">":S=o,v=l,w=a,y=">",U=">=";break;case"<":S=a,v=c,w=o,y="<",U="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(i(e,u,I))return!1;for(let P=0;P<u.set.length;++P){const E=u.set[P];let h=null,p=null;if(E.forEach(L=>{L.semver===n&&(L=new t(">=0.0.0")),h=h||L,p=p||L,S(L.semver,h.semver,I)?h=L:w(L.semver,p.semver,I)&&(p=L)}),h.operator===y||h.operator===U||(!p.operator||p.operator===y)&&v(e,p.semver))return!1;if(p.operator===U&&w(e,p.semver))return!1}return!0},Ke}var Ye,rr;function an(){if(rr)return Ye;rr=1;const s=ut();return Ye=(n,r,i)=>s(n,r,">",i),Ye}var We,nr;function cn(){if(nr)return We;nr=1;const s=ut();return We=(n,r,i)=>s(n,r,"<",i),We}var Ze,sr;function un(){if(sr)return Ze;sr=1;const s=V();return Ze=(n,r,i)=>(n=new s(n,i),r=new s(r,i),n.intersects(r,i)),Ze}var Je,ir;function ln(){if(ir)return Je;ir=1;const s=le(),t=B();return Je=(n,r,i)=>{const o=[];let a=null,l=null;const c=n.sort((f,I)=>t(f,I,i));for(const f of c)s(f,r,i)?(l=f,a||(a=f)):(l&&o.push([a,l]),l=null,a=null);a&&o.push([a,null]);const d=[];for(const[f,I]of o)f===I?d.push(f):!I&&f===c[0]?d.push("*"):I?f===c[0]?d.push(`<=${I}`):d.push(`${f} - ${I}`):d.push(`>=${f}`);const e=d.join(" || "),u=typeof r.raw=="string"?r.raw:String(r);return e.length<u.length?e:r},Je}var Qe,or;function fn(){if(or)return Qe;or=1;const s=V(),t=ue(),{ANY:n}=t,r=le(),i=B(),o=(u,f,I={})=>{if(u===f)return!0;u=new s(u,I),f=new s(f,I);let S=!1;e:for(const v of u.set){for(const w of f.set){const y=c(v,w,I);if(S=S||y!==null,y)continue e}if(S)return!1}return!0},a=[new t(">=0.0.0-0")],l=[new t(">=0.0.0")],c=(u,f,I)=>{if(u===f)return!0;if(u.length===1&&u[0].semver===n){if(f.length===1&&f[0].semver===n)return!0;I.includePrerelease?u=a:u=l}if(f.length===1&&f[0].semver===n){if(I.includePrerelease)return!0;f=l}const S=new Set;let v,w;for(const m of u)m.operator===">"||m.operator===">="?v=d(v,m,I):m.operator==="<"||m.operator==="<="?w=e(w,m,I):S.add(m.semver);if(S.size>1)return null;let y;if(v&&w){if(y=i(v.semver,w.semver,I),y>0)return null;if(y===0&&(v.operator!==">="||w.operator!=="<="))return null}for(const m of S){if(v&&!r(m,String(v),I)||w&&!r(m,String(w),I))return null;for(const C of f)if(!r(m,String(C),I))return!1;return!0}let U,P,E,h,p=w&&!I.includePrerelease&&w.semver.prerelease.length?w.semver:!1,L=v&&!I.includePrerelease&&v.semver.prerelease.length?v.semver:!1;p&&p.prerelease.length===1&&w.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(const m of f){if(h=h||m.operator===">"||m.operator===">=",E=E||m.operator==="<"||m.operator==="<=",v){if(L&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===L.major&&m.semver.minor===L.minor&&m.semver.patch===L.patch&&(L=!1),m.operator===">"||m.operator===">="){if(U=d(v,m,I),U===m&&U!==v)return!1}else if(v.operator===">="&&!r(v.semver,String(m),I))return!1}if(w){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator==="<"||m.operator==="<="){if(P=e(w,m,I),P===m&&P!==w)return!1}else if(w.operator==="<="&&!r(w.semver,String(m),I))return!1}if(!m.operator&&(w||v)&&y!==0)return!1}return!(v&&E&&!w&&y!==0||w&&h&&!v&&y!==0||L||p)},d=(u,f,I)=>{if(!u)return f;const S=i(u.semver,f.semver,I);return S>0?u:S<0||f.operator===">"&&u.operator===">="?f:u},e=(u,f,I)=>{if(!u)return f;const S=i(u.semver,f.semver,I);return S<0?u:S>0||f.operator==="<"&&u.operator==="<="?f:u};return Qe=o,Qe}var et,ar;function hn(){if(ar)return et;ar=1;const s=re(),t=oe(),n=j(),r=vr(),i=Q(),o=jr(),a=Br(),l=Vr(),c=kr(),d=Xr(),e=Hr(),u=zr(),f=Kr(),I=B(),S=Yr(),v=Wr(),w=it(),y=Zr(),U=Jr(),P=ce(),E=ot(),h=Rr(),p=Ir(),L=at(),m=ct(),C=Lr(),$=Qr(),M=ue(),k=V(),Y=le(),g=tn(),R=rn(),T=nn(),N=sn(),_=on(),O=ut(),A=an(),D=cn(),x=un(),b=ln(),G=fn();return et={parse:i,valid:o,clean:a,inc:l,diff:c,major:d,minor:e,patch:u,prerelease:f,compare:I,rcompare:S,compareLoose:v,compareBuild:w,sort:y,rsort:U,gt:P,lt:E,eq:h,neq:p,gte:L,lte:m,cmp:C,coerce:$,Comparator:M,Range:k,satisfies:Y,toComparators:g,maxSatisfying:R,minSatisfying:T,minVersion:N,validRange:_,outside:O,gtr:A,ltr:D,intersects:x,simplifyRange:b,subset:G,SemVer:n,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:t.SEMVER_SPEC_VERSION,RELEASE_TYPES:t.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},et}var dn=hn();const cr=dr(dn);var F;(function(s){s.blue="blue",s.nanoS="nanoS",s.nanoSP="nanoSP",s.nanoX="nanoX",s.stax="stax",s.europa="europa"})(F||(F={}));const tt={[F.blue]:{id:F.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:s=>4*1024},[F.nanoS]:{id:F.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:s=>{var t;return cr.lt((t=cr.coerce(s))!==null&&t!==void 0?t:"","2.0.0")?4*1024:2*1024}},[F.nanoX]:{id:F.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:s=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[F.nanoSP]:{id:F.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:s=>32},[F.stax]:{id:F.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:s=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[F.europa]:{id:F.europa,productName:"Ledger Flex",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:s=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}};F.blue,F.nanoS,F.nanoSP,F.nanoX,F.stax,F.europa;const ur=Object.values(tt),gr=11415,Nr=s=>{const t=ur.find(i=>i.legacyUsbProductId===s);if(t)return t;const n=s>>8;return ur.find(i=>i.productIdMM===n)},En=[],lr={};for(const s in tt){const t=tt[s],{bluetoothSpec:n}=t;if(n)for(let r=0;r<n.length;r++){const i=n[r];En.push(i.serviceUuid),lr[i.serviceUuid]=lr[i.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:t},i)}}var lt=function(s,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(e){try{d(r.next(e))}catch(u){a(u)}}function c(e){try{d(r.throw(e))}catch(u){a(u)}}function d(e){e.done?o(e.value):i(e.value).then(l,c)}d((r=r.apply(s,t||[])).next())})};const pn=[{vendorId:gr}];function Or(){return lt(this,void 0,void 0,function*(){return yield navigator.usb.requestDevice({filters:pn})})}function ft(){return lt(this,void 0,void 0,function*(){return(yield navigator.usb.getDevices()).filter(t=>t.vendorId===gr)})}function mn(){return lt(this,void 0,void 0,function*(){const s=yield ft();return s.length>0?s[0]:Or()})}const vn=()=>Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function");var z=function(s,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(e){try{d(r.next(e))}catch(u){a(u)}}function c(e){try{d(r.throw(e))}catch(u){a(u)}}function d(e){e.done?o(e.value):i(e.value).then(l,c)}d((r=r.apply(s,t||[])).next())})};const Rn=1,fr=3;class K extends nt{constructor(t,n){super(),this.channel=Math.floor(Math.random()*65535),this.packetSize=64,this._disconnectEmitted=!1,this._emitDisconnect=r=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",r))},this.device=t,this.interfaceNumber=n,this.deviceModel=Nr(t.productId)}static request(){return z(this,void 0,void 0,function*(){const t=yield Or();return K.open(t)})}static openConnected(){return z(this,void 0,void 0,function*(){const t=yield ft();return t.length===0?null:K.open(t[0])})}static open(t){return z(this,void 0,void 0,function*(){yield t.open(),t.configuration===null&&(yield t.selectConfiguration(Rn)),yield hr(t);const n=t.configurations[0].interfaces.find(({alternates:a})=>a.some(l=>l.interfaceClass===255));if(!n)throw new dt("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");const r=n.interfaceNumber;try{yield t.claimInterface(r)}catch(a){throw yield t.close(),new dt(a.message)}const i=new K(t,r),o=a=>{t===a.device&&(navigator.usb.removeEventListener("disconnect",o),i._emitDisconnect(new $r))};return navigator.usb.addEventListener("disconnect",o),i})}close(){return z(this,void 0,void 0,function*(){yield this.exchangeBusyPromise,yield this.device.releaseInterface(this.interfaceNumber),yield hr(this.device),yield this.device.close()})}exchange(t){return z(this,void 0,void 0,function*(){return yield this.exchangeAtomicImpl(()=>z(this,void 0,void 0,function*(){const{channel:r,packetSize:i}=this;pt("apdu","=> "+t.toString("hex"));const o=Gr(r,i),a=o.makeBlocks(t);for(let d=0;d<a.length;d++)yield this.device.transferOut(fr,a[d]);let l,c;for(;!(l=o.getReducedResult(c));){const d=yield this.device.transferIn(fr,i),e=Buffer.from(d.data.buffer);c=o.reduceResponse(c,e)}return pt("apdu","<= "+l.toString("hex")),l})).catch(r=>{throw r&&r.message&&r.message.includes("disconnected")?(this._emitDisconnect(r),new xr(r.message)):r})})}setScrambleKey(){}}K.isSupported=vn;K.list=ft;K.listen=s=>{let t=!1;mn().then(r=>{if(!t){const i=Nr(r.productId);s.next({type:"add",descriptor:r,deviceModel:i}),s.complete()}},r=>{window.DOMException&&r instanceof window.DOMException&&r.code===18?s.error(new Pr(r.message)):s.error(new yr(r.message))});function n(){t=!0}return{unsubscribe:n}};function hr(s){return z(this,void 0,void 0,function*(){try{yield s.reset()}catch(t){console.warn(t)}})}export{K as default};
